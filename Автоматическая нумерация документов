Процедура ПередЗаписью(Отказ)
    Если ЭтоНовый() Тогда
        Запрос = Новый Запрос;
        Запрос.Текст = "ВЫБРАТЬ МАКСИМУМ(Док.Номер) КАК ПоследнийНомер  
                        ИЗ Документ.ЗаказПокупателя КАК Док";  
        Результат = Запрос.Выполнить().Выбрать();  
        Если Результат.Следующий() Тогда  
            НовыйНомер = Число(Результат.ПоследнийНомер) + 1;  
        Иначе  
            НовыйНомер = 1;  
        КонецЕсли;  
        ЭтотОбъект.Номер = Формат(НовыйНомер, "ЧЦ=0000");  
    КонецЕсли;  
КонецПроцедуры
